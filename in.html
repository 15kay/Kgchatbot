<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>ChatGPT-Style Chatbot</title>
<script src="https://js.puter.com/v2/"></script>
<style>
  /* Reset and basic */
  body {
    background: #202123;
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    margin: 0; 
    height: 100vh;
    display: flex;
    flex-direction: column;
  }
  #app {
    max-width: 700px;
    margin: auto;
    height: 100vh;
    display: flex;
    flex-direction: column;
  }

  header {
    padding: 1rem;
    background: #343541;
    color: white;
    font-weight: 600;
    font-size: 1.25rem;
    text-align: center;
    user-select: none;
  }

  #chat-container {
    flex: 1;
    overflow-y: auto;
    padding: 1rem;
    background: #343541;
    display: flex;
    flex-direction: column;
    gap: 12px;
  }

  .message {
    max-width: 75%;
    padding: 12px 16px;
    border-radius: 18px;
    font-size: 1rem;
    line-height: 1.4;
    word-wrap: break-word;
    white-space: pre-wrap;
    box-shadow: 0 1px 3px rgb(0 0 0 / 0.1);
  }

  /* User message (right) */
  .message.user {
    background: #10a37f;
    color: white;
    align-self: flex-end;
    border-bottom-right-radius: 4px;
  }

  /* Bot message (left) */
  .message.bot {
    background: #444654;
    color: #d7dadc;
    align-self: flex-start;
    border-bottom-left-radius: 4px;
  }

  /* Input container */
  #input-container {
    display: flex;
    padding: 1rem;
    background: #40414f;
  }

  #user-input {
    flex: 1;
    padding: 12px 16px;
    border: none;
    border-radius: 24px;
    font-size: 1rem;
    background: #202123;
    color: white;
    outline: none;
  }

  #send-btn {
    margin-left: 8px;
    background: #10a37f;
    border: none;
    color: white;
    font-weight: 600;
    font-size: 1rem;
    padding: 0 20px;
    border-radius: 24px;
    cursor: pointer;
    transition: background 0.2s ease;
  }

  #send-btn:hover:not(:disabled) {
    background: #0e8b6e;
  }

  #send-btn:disabled {
    background: #10a37f88;
    cursor: not-allowed;
  }

  /* Typing indicator dots */
  .typing {
    display: inline-flex;
    align-items: center;
    gap: 4px;
  }

  .typing > span {
    display: inline-block;
    width: 8px;
    height: 8px;
    background: #d7dadc;
    border-radius: 50%;
    animation: blink 1.4s infinite both;
  }

  .typing > span:nth-child(1) {
    animation-delay: 0s;
  }

  .typing > span:nth-child(2) {
    animation-delay: 0.2s;
  }

  .typing > span:nth-child(3) {
    animation-delay: 0.4s;
  }

  @keyframes blink {
    0%, 80%, 100% { opacity: 0.3; }
    40% { opacity: 1; }
  }
</style>
</head>
<body>
<div id="app">
  <header>ChatGPT-Style Chatbot</header>
  <div id="chat-container"></div>

  <form id="input-container">
    <input type="text" id="user-input" autocomplete="off" placeholder="Type your message..." required />
    <button id="send-btn" type="submit">Send</button>
  </form>
</div>

<script>
  const chatContainer = document.getElementById('chat-container');
  const form = document.getElementById('input-container');
  const input = document.getElementById('user-input');
  const sendBtn = document.getElementById('send-btn');

  // Append message helper
  function appendMessage(text, sender) {
    const msgDiv = document.createElement('div');
    msgDiv.classList.add('message', sender);
    msgDiv.textContent = text;
    chatContainer.appendChild(msgDiv);
    chatContainer.scrollTop = chatContainer.scrollHeight;
    return msgDiv;
  }

  // Append typing indicator for bot
  function appendTyping() {
    const typingDiv = document.createElement('div');
    typingDiv.classList.add('message', 'bot');
    typingDiv.innerHTML = `<div class="typing"><span></span><span></span><span></span></div>`;
    chatContainer.appendChild(typingDiv);
    chatContainer.scrollTop = chatContainer.scrollHeight;
    return typingDiv;
  }

  form.addEventListener('submit', async (e) => {
    e.preventDefault();
    const userMessage = input.value.trim();
    if (!userMessage) return;

    // Show user message
    appendMessage(userMessage, 'user');
    input.value = '';
    sendBtn.disabled = true;

    // Show bot typing indicator
    const typingIndicator = appendTyping();

    try {
      // Call puter.ai.chat with your message and model
      const botResponse = await puter.ai.chat(userMessage, { model: 'gpt-4.1-nano' });
      
      // Remove typing indicator
      typingIndicator.remove();

      // Append bot response
      appendMessage(botResponse, 'bot');
    } catch (error) {
      typingIndicator.remove();
      appendMessage('Oops! Something went wrong. Please try again.', 'bot');
      console.error(error);
    } finally {
      sendBtn.disabled = false;
      input.focus();
    }
  });
</script>
</body>
</html>
